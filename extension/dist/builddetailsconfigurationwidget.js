define(["TFS/Build/Contracts","TFS/Build/RestClient"],function(t,n){return function(t){function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=9)}({0:function(n,e){n.exports=t},1:function(t,e){t.exports=n},9:function(t,n,e){var i,o,r=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))(function(o,r){function a(t){try{s(i.next(t))}catch(t){r(t)}}function u(t){try{s(i.throw(t))}catch(t){r(t)}}function s(t){t.done?o(t.value):new e(function(n){n(t.value)}).then(a,u)}s((i=i.apply(t,n||[])).next())})},a=this&&this.__generator||function(t,n){function e(t){return function(n){return i([t,n])}}function i(e){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&e[0]?"return":e[0]?"throw":"next"])&&!(a=a.call(r,e[1])).done)return a;switch(r=0,a&&(e=[0,a.value]),e[0]){case 0:case 1:a=e;break;case 4:return s.label++,{value:e[1],done:!1};case 5:s.label++,r=e[1],e=[0];continue;case 7:e=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===e[0]||2===e[0])){s=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){s.label=e[1];break}if(6===e[0]&&s.label<a[1]){s.label=a[1],a=e;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(e);break}a[2]&&s.ops.pop(),s.trys.pop();continue}e=n.call(t,s)}catch(t){e=[6,t],r=0}finally{o=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var o,r,a,u,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u};i=[e,n,e(0),e(1)],void 0!==(o=function(t,n,e,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),VSS.require(["TFS/Dashboards/WidgetHelpers"],function(t){t.IncludeWidgetConfigurationStyles(),VSS.register("TPHealth-DetailsWidget-Configuration",function(){return new o(t)}),VSS.notifyLoadSucceeded()});var o=function(){function t(t){this.WidgetHelpers=t,this.widgetConfigurationContext=null,this.definitionDropDown=$("#definitionDropDown"),this.errordropdown=$("#definitionDropDown .validation-error > .validation-error-text")}return t.prototype.load=function(t,n){return r(this,void 0,void 0,function(){var e,i,o;return a(this,function(r){switch(r.label){case 0:return this.widgetConfigurationContext=n,e=JSON.parse(t.customSettings.data),e&&e.definitionId||(i=this.definitionDropDown,o="Select a build definition",i.append($('<option style="font-style:italic" />').val(-1).text(o))),[4,this.loadBuildDefinitions(e)];case 1:return r.sent(),this.notifyOnChange(this.definitionDropDown),[2,this.WidgetHelpers.WidgetStatusHelper.Success()]}})})},t.prototype.loadBuildDefinitions=function(t){return r(this,void 0,void 0,function(){var n,o,r,u,s,d,l;return a(this,function(a){switch(a.label){case 0:return n=i.getClient(),o=VSS.getWebContext(),[4,n.getDefinitions(o.project.id,void 0,void 0,void 0,void 0,e.DefinitionQueryOrder.DefinitionNameAscending)];case 1:for(r=a.sent(),u=this.definitionDropDown,s=0,d=r;s<d.length;s++)l=d[s],t&&t.definitionId&&l.id.toString()===t.definitionId.toString()?u.append($("<option selected/>").val(l.id).text(l.name)):u.append($("<option />").val(l.id).text(l.name));return[2]}})})},t.prototype.validateQueryDropdown=function(t,n){if("-1"===this.definitionDropDown.val()){return n.text("Please select a build definition"),n.parent().css("visibility","visible"),!1}return n.parent().css("visibility","hidden"),!0},t.prototype.notifyOnChange=function(t){var n=this;t.change(function(){n.validateQueryDropdown(n.definitionDropDown,n.errordropdown)&&($("#definitionDropDown option[value='-1']").remove(),n.widgetConfigurationContext.notify(n.WidgetHelpers.WidgetEvent.ConfigurationChange,n.WidgetHelpers.WidgetEvent.Args(n.getCustomSettings())))})},t.prototype.getCustomSettings=function(){var t={definitionId:this.definitionDropDown.val()};return{data:JSON.stringify(t)}},t.prototype.onSave=function(){return"-1"===this.definitionDropDown.val()?this.WidgetHelpers.WidgetConfigurationSave.Invalid():this.WidgetHelpers.WidgetConfigurationSave.Valid(this.getCustomSettings())},t}()}.apply(n,i))&&(t.exports=o)}})});