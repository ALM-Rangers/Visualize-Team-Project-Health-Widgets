define(function(){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}({13:function(e,t,n){var i,o,r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,r){function s(e){try{d(i.next(e))}catch(e){r(e)}}function a(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,a)}d((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;d;)try{if(o=1,r&&(s=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return d.label++,{value:n[1],done:!1};case 5:d.label++,r=n[1],n=[0];continue;case 7:n=d.ops.pop(),d.trys.pop();continue;default:if(s=d.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){d=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){d.label=n[1];break}if(6===n[0]&&d.label<s[1]){d.label=s[1],s=n;break}if(s&&d.label<s[2]){d.label=s[2],d.ops.push(n);break}s[2]&&d.ops.pop(),d.trys.pop();continue}n=t.call(e,d)}catch(e){n=[6,e],r=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,s,a,d={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};i=[n,t,!function(){var e=new Error('Cannot find module "ReleaseManagement/Core/Contracts"');throw e.code="MODULE_NOT_FOUND",e}(),!function(){var e=new Error('Cannot find module "ReleaseManagement/Core/RestClient"');throw e.code="MODULE_NOT_FOUND",e}()],void 0!==(o=function(e,t,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),VSS.require(["TFS/Dashboards/WidgetHelpers"],function(e){e.IncludeWidgetConfigurationStyles(),VSS.register("TPHealth-ReleaseDetailsWidget-Configuration",function(){return new o(e)}),VSS.notifyLoadSucceeded()});var o=function(){function e(e){this.WidgetHelpers=e,this.widgetConfigurationContext=null,this.definitionDropDown=$("#definitionDropDown"),this.errordropdown=$("#definitionDropDown .validation-error > .validation-error-text"),this.showRejectedAsFailedCheckbox=$("#showRejectedAsFailed"),this.showRejectedAsFailed=!0}return e.prototype.load=function(e,t){return r(this,void 0,void 0,function(){var n,i,o,r;return s(this,function(s){switch(s.label){case 0:return this.widgetConfigurationContext=t,n=JSON.parse(e.customSettings.data),n&&n.definitionId||(i=this.definitionDropDown,o="Select a release definition",i.append($('<option style="font-style:italic" />').val(-1).text(o))),n&&(this.showRejectedAsFailed=n.showRejectedAsFailed),this.showRejectedAsFailedCheckbox.prop("checked",this.showRejectedAsFailed),[4,this.loadReleaseDefinitions(n)];case 1:return s.sent(),this.notifyOnChange(this.definitionDropDown),r=this,this.showRejectedAsFailedCheckbox.change(function(e){r.showRejectedAsFailed=this.checked,r.widgetConfigurationContext.notify(r.WidgetHelpers.WidgetEvent.ConfigurationChange,r.WidgetHelpers.WidgetEvent.Args(r.getCustomSettings()))}),[2,this.WidgetHelpers.WidgetStatusHelper.Success()]}})})},e.prototype.notifyOnChange=function(e){var t=this;e.change(function(){t.validateQueryDropdown(t.definitionDropDown,t.errordropdown)&&($("#definitionDropDown option[value='-1']").remove(),t.widgetConfigurationContext.notify(t.WidgetHelpers.WidgetEvent.ConfigurationChange,t.WidgetHelpers.WidgetEvent.Args(t.getCustomSettings())))})},e.prototype.getCustomSettings=function(){var e={definitionId:this.definitionDropDown.val(),showRejectedAsFailed:this.showRejectedAsFailed};return{data:JSON.stringify(e)}},e.prototype.onSave=function(){return"-1"===this.definitionDropDown.val()?this.WidgetHelpers.WidgetConfigurationSave.Invalid():this.WidgetHelpers.WidgetConfigurationSave.Valid(this.getCustomSettings())},e.prototype.loadReleaseDefinitions=function(e){return r(this,void 0,void 0,function(){var t,o,r,a,d,u,l;return s(this,function(s){switch(s.label){case 0:return t=i.getClient(),o=VSS.getWebContext(),[4,t.getReleaseDefinitions(o.project.id,void 0,void 0,void 0,void 0,void 0,void 0,n.ReleaseDefinitionQueryOrder.NameAscending)];case 1:for(r=s.sent(),a=this.definitionDropDown,d=0,u=r;d<u.length;d++)l=u[d],e&&e.definitionId&&l.id.toString()===e.definitionId.toString()?a.append($("<option selected/>").val(l.id).text(l.name)):a.append($("<option />").val(l.id).text(l.name));return[2]}})})},e.prototype.validateQueryDropdown=function(e,t){if("-1"===this.definitionDropDown.val()){return t.text("Please select a release definition"),t.parent().css("visibility","visible"),!1}return t.parent().css("visibility","hidden"),!0},e}()}.apply(t,i))&&(e.exports=o)}})});