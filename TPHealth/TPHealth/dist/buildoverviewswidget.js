define(["TFS/Build/Contracts","TFS/Build/RestClient"],function(t,e){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}([function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){var i,o;i=[n,e,n(3)],void 0!==(o=function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.disableTelemetry="false",this.disableAjaxTracking="false",this.enableDebug="false"}return t}();e.TelemetryClientSettings=i;var o=function(){function t(){this.IsAvailable=!0}return t.getClient=function(e){return this._instance||(console.log("Creating new TelemetryClient!"),this._instance=new t,this._instance.Init(e)),this._instance},t.prototype.Init=function(t){console.log("TelemetryClient settings key: "+t.key.substring(0,8)+"************"),console.log("TelemetryClient settings extension context: "+t.extensioncontext),console.log("TelemetryClient settings disableTelemetry: "+("true"===t.disableTelemetry)),console.log("TelemetryClient settings disableAjaxTracking: "+("true"===t.disableAjaxTracking)),console.log("TelemetryClient settings enableDebug: "+("true"===t.enableDebug));var e={instrumentationKey:t.key,disableTelemetry:"true"===t.disableTelemetry,disableAjaxTracking:"true"===t.disableAjaxTracking,enableDebug:"true"===t.enableDebug};this.ExtensionContext=t.extensioncontext;try{var i=VSS.getWebContext();n.AppInsights.downloadAndSetup(e),n.AppInsights.setAuthenticatedUserContext(i.user.id,i.collection.id)}catch(t){console.log(t)}},t.prototype.trackPageView=function(t,e,i,o,r){try{n.AppInsights.trackPageView(this.ExtensionContext+"."+t,e,i,o,r),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackEvent=function(t,e,i){try{console.log("Tracking event: "+this.ExtensionContext+"."+t),n.AppInsights.trackEvent(this.ExtensionContext+"."+t,e,i),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackException=function(t,e,i,o){try{console.error(t);var r={name:this.ExtensionContext+"."+e,message:t};n.AppInsights.trackException(r,e,i,o),n.AppInsights.flush()}catch(t){console.log(t)}},t.prototype.trackMetric=function(t,e,i,o,r,s){try{n.AppInsights.trackMetric(this.ExtensionContext+"."+t,e,i,o,r,s),n.AppInsights.flush()}catch(t){console.log(t)}},t}();e.TelemetryClient=o}.apply(e,i))&&(t.exports=o)},function(t,e,n){"use strict";var i,o,r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){!function(t){var e=function(){function t(){}return t}();t.Base=e}(t.Telemetry||(t.Telemetry={}))}(r||(r={}));var r;!function(t){!function(t){var e=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();t.Envelope=e}(t.Telemetry||(t.Telemetry={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){!function(t){t.Context||(t.Context={})}(t.ApplicationInsights||(t.ApplicationInsights={}))}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={}));var s;!function(t){!function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"}(t.SeverityLevel||(t.SeverityLevel={}))}(s||(s={}));var r;!function(t){t.ApplicationInsights||(t.ApplicationInsights={})}(r||(r={})),i=[n,e],void 0!==(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t._createLazyMethod=function(e){var n=window[t.appInsightsName];n[e]=function(){var t=arguments;n.queue?n.queue.push(function(){return n[e].apply(n,t)}):n[e].apply(n,t)}},t._defineLazyMethods=function(){var e=window[t.appInsightsName];try{e.cookie=document.cookie}catch(t){}e.queue=[];for(var n=["clearAuthenticatedUserContext","flush","setAuthenticatedUserContext","startTrackEvent","startTrackPage","stopTrackEvent","stopTrackPage","trackDependency","trackEvent","trackException","trackMetric","trackPageView","trackTrace"];n.length;)t._createLazyMethod(n.pop())},t._download=function(e){t.appInsightsInstance.config=e;var n=window[t.appInsightsName];if(n.queue||(n.queue=[]),setTimeout(function(){var t=document.createElement("script");t.src=e.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",document.head.appendChild(t)}),!e.disableExceptionTracking){t._createLazyMethod("_onerror");var i=window.onerror;window.onerror=function(t,e,o,r,s){var a=i&&i(t,e,o,r,s);return!0!==a&&n._onerror(t,e,o,r,s),a}}},Object.defineProperty(t,"appInsightsInstance",{get:function(){if("undefined"!=typeof window)return window[t.appInsightsName]||(window[t.appInsightsName]={downloadAndSetup:t._download,_defineLazyMethods:t._defineLazyMethods},t._defineLazyMethods()),window[t.appInsightsName]},enumerable:!0,configurable:!0}),t.appInsightsInitialized=!1,t.appInsightsName="appInsights",t}();e.AppInsights=n.appInsightsInstance}.apply(e,i))&&(t.exports=o)},function(t,e,n){var i,o;i=[n,e],void 0!==(o=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.settings={disableAjaxTracking:"false",disableTelemetry:"false",enableDebug:"false",extensioncontext:"FolderManagement",key:"__InstrumentationKey__"}}.apply(e,i))&&(t.exports=o)},,,function(t,e,n){var i,o;i=[n,e],void 0!==(o=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e,n){this.Failed=t,this.Succeeded=e,this.InProgress=n}return t}();e.Overview=n}.apply(e,i))&&(t.exports=o)},,,,,function(t,e,n){var i,o,r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(s,a)}c((i=i.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(s=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){c.label=n[1];break}if(6===n[0]&&c.label<s[1]){c.label=s[1],s=n;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(n);break}s[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(t){n=[6,t],r=0}finally{o=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};i=[n,e,n(2),n(0),n(1),n(7),n(4)],void 0!==(o=function(t,e,n,i,o,a,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),VSS.require(["TFS/Dashboards/WidgetHelpers"],function(t){t.IncludeWidgetStyles(),VSS.register("TPHealth-OverviewWidget",function(){return new u(t)}),VSS.notifyLoadSucceeded()});var u=function(){function t(t){this.WidgetHelpers=t}return t.prototype.load=function(t){return r(this,void 0,void 0,function(){return s(this,function(e){return n.TelemetryClient.getClient(c.settings).trackPageView("BuildOverview"),this.ShowOverviewData(t),[2,this.WidgetHelpers.WidgetStatusHelper.Success()]})})},t.prototype.reload=function(t){return r(this,void 0,void 0,function(){return s(this,function(e){return this.ShowOverviewData(t),[2,this.WidgetHelpers.WidgetStatusHelper.Success()]})})},t.prototype.ShowOverviewData=function(t){return r(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return $(".title").text(t.name),[4,this.showBuild(t)];case 1:return e.sent(),[2]}})})},t.prototype.showBuild=function(t){return r(this,void 0,void 0,function(){var e,n,r,c,u,l,p;return s(this,function(s){switch(s.label){case 0:return e=o.getClient(),n=VSS.getWebContext(),r=new a.Overview(0,0,0),c=JSON.parse(t.customSettings.data),[4,e.getDefinitions(n.project.name)];case 1:return u=s.sent(),c&&c.selectedDefinitions&&(u=u.filter(function(t){return-1!==c.selectedDefinitions.indexOf(t.name)})),l=u.map(function(t){return t.id}),l.length>0?[4,e.getBuilds(n.project.name,l,null,null,null,null,null,null,null,null,null,null,null,null,null,1)]:[3,3];case 2:return p=s.sent(),p.forEach(function(t){t.result===i.BuildResult.Succeeded?r.Succeeded++:t.result===i.BuildResult.Canceled?r.Failed++:t.result===i.BuildResult.Failed?r.Failed++:t.result===i.BuildResult.PartiallySucceeded?r.Failed++:t.result===i.BuildResult.None?r.InProgress++:t.status===i.BuildStatus.InProgress?r.InProgress++:t.status===i.BuildStatus.NotStarted&&r.InProgress++}),$("#failed").text(r.Failed),$("#inprogress").text(r.InProgress),$("#succeeded").text(r.Succeeded),$("#container").removeClass("building success fail"),r.Failed>0?$("#container").addClass("fail"):r.InProgress>0?$("#container").addClass("building"):$("#container").addClass("success"),[3,4];case 3:$("#nodata").text("No build definitions found"),s.label=4;case 4:return[2]}})})},t}();e.OverviewWidget=u}.apply(e,i))&&(t.exports=o)}])});